---
title: 红黑树
date: 2020-07-07 11:31:49
type: "数据结构和算法"
layout: "数据结构和算法"
---

# 红黑树

## 二叉搜索树的缺陷

* 二叉搜索树查找某一结点次数等于该节点的度
* 如果节点都在根的一侧（非平衡树）会增加查找次数
* 为了解决这个平衡性问题需要一种算法，这种算法结合的树就是红黑树

![缺陷](./01.jpg)

## 规则

* 节点必须是红色或黑色
* 根节点只能是黑色
* 每个叶子节点都是黑色的空节点
   * 在二叉搜索树的基础上，把每个叶子节点都补充两个黑色null节点
* 每个红色节点两个子节点必须都是黑色的
* 任何一个节点到其每个叶子的所有路径都包含相同数目的黑色节点
* 根到叶子最长路径，不会超过最短可能路径的两倍
   * 黑色=n，红色<=n-1  ===>  n+n-1=2n-1<2n
   
## 红黑树的变换

* 变色
   * 插入节点时首先选则红色
* 左旋转
   * 逆时针旋转红黑树的两个节点
   * 右节点变为自己的父节点
   * 自己变为右节点的左节点
   * 右节点的左节点变为自己的右节点
   * 其他都不变

![左旋转1](./01.gif)
![左旋转2](./02.png)

* 右旋转
   * 顺时针旋转红黑树的两个节点
   * 左节点变为自己的父节点
   * 自己变为左节点的右节点
   * 左节点的右节点变为自己的左节点
   * 其他都不变
   
![右旋转1](./02.gif)
![右旋转2](./03.png)

## 插入节点

* 情况1==>新增节点N位于根上，没有父节点
   * 直接将红色变成黑色即可
* 情况2==>新增节点N父节点为黑色
   * 直接添加即可
* 情况3==>新增节点N父节点（P）为红色，叔叔节点（U）也为红色，祖父节点（G）为黑
   * P,U,G全部变为相反颜色
   * G的父节点为红色，则递归调用，到根节点为红色则需要旋转
* 情况4==>新增节点N父节点（P）为红色，叔叔节点（U）为黑，祖父节点（G）为黑，N为左节点
   * P,G全部变为相反颜色，之后进行右旋转
* 情况5==>新增节点N父节点（P）为红色，叔叔节点（U）为黑，祖父节点（G）为黑，N为右节点
   * 以P为根左旋转
   * 将P作为新插入的节点考虑即可（见详情4）

# 案例

案例：插入10，9，8，7，6，5，4，3，2，1到红黑树中

![红黑树](./01.png)