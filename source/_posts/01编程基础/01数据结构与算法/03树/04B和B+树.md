---
title: B和B+树
date: 2020-07-07 12:31:49
type: "数据结构和算法"
layout: "数据结构和算法"
---

# B树

## 红黑树缺点
* 如果是Mysql的存储需要把数据存储在磁盘上
* 二叉树层级太深，每一层都是一次磁盘读写
* 二叉树每个节点只保存一个值造成资源浪费
* B 树是为磁盘等存储设备设计的一种平衡查找树

## B树特点


* 每个节点存储多个元素
* 摒弃二叉树结构，采用多叉树
* 每个节点至多可以拥有M棵子树(M为阶)
* 每个节点有M-1个key，并且以升序排列
* 根节点至少有1个key

## B树插入
![B树插入](./03.gif)

## B树删除

![B树插入](./04.gif)

## B树插入案例1

往B树中依次插入6 10 4 14 5 11 15 3 2 12 1 7 8 8 6 3 6 21 5 15 15 6 32 23 45 65 7 8 6 5 4

![B树插入](./01.png)

## B树插入案例2

往B树中依次插入6 10 4 14 5 11 15 3 2 12 1 7 8 8 6 3 6 21 5 15 15 6 32 23 45 65 7 8 6 5 4

![B树插入](./01.gif)

# B+树

## B树问题

* 读取key为“66”与“73”的数据
* 从根节点“50”开始，“66”大于“50”，找右孩子，即到“60 70 120”的节点，再锁定到“64 66”的节点，找到key为“66”的数据
* 然后读“73”的数据，再重新从根开始往下寻找key为“73”的数据
* 数据量一多，性能就很糟糕
* 在经过路径上的非叶子节点也会被读出（60，70，120），但实际上这部分数据我是不需要的，这样又占用了没有必要的内存空间

![B树问题](./02.png)

## B+树特点

* 有 k 个子节点的节点必然有 k 个key；
* 非叶子节点仅具有索引作用，跟记录有关的信息均存放在叶子节点中。
* 树的所有叶子节点构成一个有序链表，可以按照key排序的次序遍历全部记录。

![B+树特点](./03.png)

> B+树的叶子结点都是相链的，因此对整棵树的便利只需要一次线性遍历叶子结点即可
> B*树是B+树的变体，在B+树的非根和非叶子结点再增加指向兄弟的指针

## B+树插入

往B+树中依次插入6 10 4 14 5 11 15 3 2 12 1 7 8 8 6 3 6 21 5 15 15 6 32 23 45 65 7 8 6 5 4

![B+树插入](./02.gif)
